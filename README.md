This is code from netlabs usable across multiple situations
